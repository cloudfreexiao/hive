
### 工程相关
执行create_lmake.bat自动生成makefile及vs工程代码,这步不修改目录或增减文件一般无需执行
其工作原理是调用了lmake工具,通过目录的*.lmak文件的配置,根据模板自动生成

###  编译
  - [windows] 通过vs编译,或者build.bat一键编译
  - [linux,mac] 执行build.sh或手动执行make脚本

###  测试
  - [单元测试] bin目录下start_test.bat / start_test.sh
  - [集群测试] bin目录下start.bat / start.sh
  - 这些只是框架的基础通用服务,具体的服务需要编写相应的代码启动

###  如何开发一个服务
  - [服务配置]  每个服务启动会做服务的名字及id检测,用于路由消息.
               参考deploy/service.xlsm配置添加自己的服务
  - [cache配置]    配置玩家数据对象的缓存及关联的mongodb表格,可以做聚合或非聚合方式
  - [database配置] 配置数据库相关的配置,dbsvr或根据配置自动启动相应的连接服务
  - [router配置]   路由服的配置,启动的路由服数量,ip.其它服主动连接router服
  - [示例] 开发一个聊天服务
    - 启动聊天服务,init.lua中加载相关lua代码,即可接入集群与其它服务通讯
  - ```lua
    import("kernel.lua")
    hive.startup(function()
    --初始化
    import("chat/init.lua")
    end)
    ```
### 核心路由接口示例
  
  - ```lua
    --给全部lobby服调用group_message接口
    router_mgr:send_lobby_all("group_message", players, cmd_id, data)
    --根据player_id做hash调用指定的room服的rpc_create_contest接口并等待返回
    router_mgr:call_room_hash(player_id, "rpc_create_contest", user, config)
    --给master服务进程admin调用rpc_execute_command并等待返回
    router_mgr:call_admin_master("rpc_execute_command", command)
    ```
  - 路由管理器会根据服务配置表自动生成send/call_xxx_all,send/call_xxx_hash,send/call_xxx_master接口
    分别应对send/call的各种逻辑场景

### RPC工作流程
   1. 请求--->保存上下文--->异步逻辑(其他后台服务)
   2. 异步逻辑回包--->恢复上下文--->本地逻辑--->保存上下文--->异步逻辑(其他后台服务) 
   3. 异步逻辑回包--->恢复上下文--->本地逻辑--->响应请求
   4. 超时处理:创建任务时, 分配唯一ID,也即是异步网络协议中必须传输的唯一标识上下文的ID. 
      超时后以超时方式唤醒该协程.继续执行
   5. 注意并发情况使用协程锁(队列)

### 项目引用方式

   - 建议单独拉取git,编译拷贝hive/bin,hive/script,hive/server,hive/tools 到项目project/hive下面
     减少引入太多文件导致项目臃肿


